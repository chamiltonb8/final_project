---
title: "Documentation for the stat386stonks package"
jupyter: python3
execute:
  python: ./.venv/bin/python
---

```{python}
#| label: load_package_setup
#| include: false
import runpy

runpy.run_path("scripts/quarto_setup.py")
```

## **Introduction**
We created this package so that people can analyze historical data from some of the most well-known stocks, compare them to each other, and use models to predict what stock prices may be in the future. Predicting the stock market is a dream for almost everyone involved in investing. Knowing the future would allow investors to make immense profits. Although the predictive models we added do not give exact predictions and can be wrong, they provide insight into what future stock prices may look like based on historical data. We want to disclose that these models are not perfect, and one should not carelessly invest in the stocks included in our package solely based on our models.

## **Preparing the Data**
### **Acquiring the Data**

The dataset comes from the **Alpha Vantage API**, which provides publicly accessible financial market data, including historical and real-time prices for stocks, ETFs, cryptocurrencies, and forex. For this project, we only use historical stock prices. The data includes key information such as open, high, low, and close prices, trading volume, and adjusted close values for equities, along with metadata like the ticker symbol, time interval, and last refreshed date. The API allows data to be grouped by daily, weekly, or monthly intervals.

Accessing the API requires creating a free Alpha Vantage account, and data collection is legal as long as it is not used for commercial purposes and rate limits are respected. Because the free API has usage limits, we collected data in two stages: first retrieving five years of weekly data for seven stocks and saving it to a CSV file, then modifying the code to retrieve the next five years of data and saving it to a separate CSV file. These two CSV files were then combined into a single dataset, which we used for data cleaning. We also chose to use weekly data instead of daily data in order to maximize the amount of historical data we could obtain within the API’s free limits while still capturing meaningful trends.

### **Cleaning the Data**

Some data cleaning occurred during the process of combining the two CSV files. The column names originally contained numbers at the beginning, which we removed so that only the column names remained and were consistently capitalized. We also ensured that the data was sorted first by stock symbol and then by date so that time series plots would be accurate. Without this step, the graphs and analysis would not reflect the true trends in the data.

We added two new variables using information from the API. The first was *Close_diff*, which groups the data by stock and computes the difference in adjusted closing price between the current week and the previous week. The adjusted closing price accounts for events such as stock splits, which occurred for some of the stocks in our dataset and would otherwise distort the analysis.

The second variable we created was *Pct_Change*, which groups the data by stock and calculates the percent change in adjusted closing price relative to the first data point for that stock. This allows for better comparisons across stocks, as percent growth is more meaningful to investors than raw price levels.

## **Analysis**
### **Plotting**

When comparing adjusted closing prices across the stocks we analyzed, ordered from highest to lowest, the ranking is the *S&P 500, Meta, Microsoft, Tesla, Google, Apple,* and *Amazon*. This ranking reflects prices as of approximately 12/1/25, when we last retrieved data from the API. This ordering is very similar to what it was ten years ago, with the main exception being *Tesla*, which rose from near the bottom to become the fourth-highest stock among the seven analyzed. The remaining stocks maintained similar rankings or were very close to one another.

![Close Price All Stocks](images/output.png)

The graphs also show a sizable decrease in stock prices from approximately 2022 to 2024. This decline aligns with a period of extremely high inflation driven by post-pandemic supply chain disruptions and strong consumer demand supported by earlier stimulus efforts.

Comparing stocks based on their percent change over the last ten years, all of them experienced substantial growth, with the lowest increase around 286% and the highest near 2700%. Ordered from highest to lowest growth over the ten-year period, the ranking is *Tesla, Apple, Microsoft, Google, Amazon, Meta,* and the *S&P 500*. We were surprised to see that the *S&P 500* achieved only about half the growth of *Meta*, the second-lowest stock in this ranking. This result is reasonable, however, since the individual stocks analyzed are primarily technology companies that have experienced significant growth over the past decade, whereas the *S&P 500* represents a diversified index of the top 500 companies and is generally considered a safer, but still rewarding, investment.

![Percent Change All Stocks](images/output2.png)

### **Summary Tables**

We included summary tables to display numerical values for percent change, volatility, and the mean weekly percent increase for each stock.

Volatility measures how unpredictable a stock’s price movements are and provides insight into its risk level. Higher volatility indicates larger and more frequent price changes, while lower volatility suggests greater stability and potentially lower risk for long-term investors. From highest to lowest volatility, the stocks are *Amazon, Google, Tesla, Apple, Meta*, the *S&P 500*, and *Microsoft*. We were surprised that *Tesla* did not have the highest volatility, since the graphs show large price swings that visually appear very extreme. However, while *Tesla’s* volatility is still relatively high as the third most volatile stock, its value is around 95, compared to *Apple’s* volatility of only 18. We were also surprised to see that the *S&P 500*, often considered the safest long-term investment option, did not have the lowest volatility—*Microsoft* did. That said, the difference between their volatilities was less than one standard deviation, so they are not drastically different.

The final statistic we examined was the mean weekly percent increase in a stock’s closing price. This metric provides a long-term view of price trends and momentum while smoothing out some of the short-term “noise” present in the stock market. It helps estimate how much a stock might be expected to increase on an average week. This information can be useful for both short-term and long-term investors. A high average weekly increase may appeal to short- or medium-term investors, even if the stock is more volatile, while also offering reassurance to long-term investors that growth is occurring consistently over time.

## **Modeling**

To Explore more about whether or not historical stock data has predictive information, we decided to fit a liner regression model at each individual stock level. Weekly returns were computed from adjusted closing prices, and the response variable was defined as the next-period return. Two predictors were used: the current-period return and the percent change in trading volume. These features were chosen because they are easily interpretable and commonly used in other financial analysis. 

Models were trained by using a time-based train/test split to preserve the data sctructures and better relflect a forecasting setting. Model performace is evaluated using the standard metrics of R^2 and MSE. Overall, the results indicated that predictive power is limited. Because the market is so volatile. the modeling component now focuses more on EDA and a baseline of demonstrating how statiscal models can be implemented to these data and in the data science pipline. 

## **Conclusion**

From our analysis, we found that *Tesla* experienced the largest increase over the past ten years among the seven stocks examined. Surprisingly, the *S&P 500* did not perform as strongly as expected when compared to major individual stocks such as *Tesla, Apple, Microsoft, Google, Meta*, and *Amazon*.

[Write about modeling]

This analysis could be improved by using daily stock prices instead of weekly prices; however, we were limited by the amount of data available through the free API. The study could also be expanded by including stocks outside of the *S&P 500*, or stocks that experienced extreme short-term gains followed by large losses, such as GameStop. Including a wider variety of stocks would provide a broader perspective, allow for deeper insights, and help make the predictive models more generalizable by better capturing market noise and volatility.
